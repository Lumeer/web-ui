<div class="wrapper h-100" *ngIf="{permissions: permissions$ | async, summaries: config | kanbanHeaderSummaries:collections:documents:linkTypes:linkInstances:constraintData} as data">
  <div class="d-inline-flex flex-row flex-nowrap h-100 align-items-start mr-4"
       cdkDropList cdkDropListOrientation="horizontal"
       (cdkDropListDropped)="dropColumn($event)">
    <kanban-column *ngFor="let column of config.columns; trackBy: trackByColumn; let first = first"
                   cdkDrag #kanbanColumn
                   [cdkDragDisabled]="!canManageConfig"
                   [cdkDragStartDelay]="dragDelay"
                   class="column ml-3"
                   [column]="column"
                   [config]="config"
                   [dragColumnsIds]="column | kanbanDragColumns:config.columns"
                   [collections]="collections"
                   [linkTypes]="linkTypes"
                   [canManageConfig]="canManageConfig"
                   [cards]="column | kanbanColumnCards:documents:collections:config"
                   [query]="query"
                   [summary]="data.summaries && data.summaries[column.id]"
                   [permissions]="data.permissions"
                   [constraintData]="constraintData"
                   (createResource)="createObjectInResource($event, column)"
                   (updateDocument)="onUpdateDocument($event)"
                   (columnsChange)="onColumnsChange($event)"
                   (removeColumn)="onRemoveColumn(column)"
                   (toggleFavorite)="onToggleFavorite($event)">
    </kanban-column>

    <kanban-column *ngIf="config.otherColumn?.resourcesOrder?.length > 0"
                   class="column ml-3" #kanbanColumn
                   [column]="config.otherColumn"
                   [config]="config"
                   [dragColumnsIds]="config.otherColumn | kanbanDragColumns:config.columns"
                   [collections]="collections"
                   [canManageConfig]="canManageConfig"
                   [permissions]="data.permissions"
                   [cards]="config.otherColumn | kanbanColumnCards:documents:collections:config"
                   [query]="query"
                   [summary]="data.summaries && data.summaries[config.otherColumn.id]"
                   [constraintData]="constraintData"
                   (createResource)="createObjectInResource($event, config.otherColumn)"
                   (updateDocument)="onUpdateDocument($event)"
                   (columnsChange)="onColumnsChange($event)"
                   (toggleFavorite)="onToggleFavorite($event)">
    </kanban-column>
  </div>
</div>
