<ng-container *ngIf="{collections: collections$ | async,  config: config$ | async,
                canManageConfig: currentView$ | async | canManageConfig | async,
                documents: documents$ | async, query: query$ | async,
                users: users$ | async} as data">

  <collapsible-sidebar *ngIf="data.canManageConfig"
                       class="h-100"
                       [collapsed]="!(sidebarOpened$ | async)"
                       (toggle)="onSidebarToggle()">
    <kanban-config
      class="d-block m-3"
      [collections]="data.collections"
      [documents]="data.documents"
      [config]="data.config"
      [query]="data.query"
      (configChange)="onConfigChanged($event)"
      [constraintData]="{users: data.users, durationUnitsMap: durationUnitsMap}">
    </kanban-config>
  </collapsible-sidebar>

  <kanban-columns
    class="flex-grow-1 h-100"
    [collections]="data.collections"
    [config]="data.config"
    [query]="data.query"
    [documents]="data.documents"
    [canManageConfig]="data.canManageConfig"
    [constraintData]="{users: data.users, durationUnitsMap: durationUnitsMap}"
    (configChange)="onConfigChanged($event)"
    (patchData)="onPatchData($event)"
    (removeDocument)="onRemoveDocument($event)">

  </kanban-columns>

</ng-container>
