<ng-container *ngFor="let column of columns; let index = index; trackBy: trackByColumn">

  <ng-container
    *ngIf="{dataValue: row.documentData[column.attribute.id] | dataValue:column.attribute.constraint, focused: selectedCell | tableCellSelected:column:cellType:row, edited: column.id === editedColumnId} as data">
    <td *ngIf="true"
        [style.width.px]="column.width"
        [class.color]="column.attribute?.constraint?.type === constraintType.Color"
        [class.focused]="data.focused"
        [class.editing]="data.edited"
        [class.cursor-pointer]="column.editable"
        (click)="onDataInputClick(column.id, $event)"
        (dblclick)="onDataInputDblClick(column.id, $event)">
      <data-input
        [constraint]="column.attribute.constraint"
        [cursor]="row | tableRowDataCursor:column"
        [dataValue]="(editedValue | isNotNullOrUndefined) && data.edited === index ? editedValue : data.dataValue"
        [focus]="true"
        [readonly]="!column.editable || !(data.edited || column.attribute?.constraint?.type === constraintType.Boolean)"
        [configuration]="configuration"
        (save)="onNewValue(column, $event)"
        (cancel)="onDataInputCancel(column)"
        (enterInvalid)="onEnterInvalid()">
      </data-input>
    </td>
    <td *ngIf="false"
        [innerHTML]="data.dataValue | previewDataValue | safeHtml"
        [style.width.px]="column.width"
        [class.focused]="data.focused"
        class="text-pre overflow-hidden mx-1 align-middle"
        [title]="data.dataValue | formatDataValueTitle"
        [ngClass]="column.attribute?.constraint | constraintClass"
        [class.invalid-value]="!(data.dataValue | isDataValueValid)"
        (click)="onDataInputClick(column.id, $event)">
    </td>
  </ng-container>
</ng-container>
