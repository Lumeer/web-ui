<ng-container *ngFor="let column of columns; let index = index; trackBy: trackByColumn">

  <ng-container
    *ngIf="{dataValue: row.documentData[column.attribute.id] | dataValue:column.attribute.constraint, columnFocused: columnFocused$ | async, columnEditing: columnEditing$ | async} as data">
    <td *ngIf="true"
        [style.width.px]="column.width"
        [class.color]="column.attribute?.constraint?.type === constraintType.Color"
        [class.focused]="data.columnFocused === index"
        [class.editing]="data.columnEditing === index"
        [class.cursor-pointer]="column.editable">
      <data-input
        [constraint]="column.attribute.constraint"
        [cursor]="row | tableRowDataCursor:column"
        [dataValue]="(editedValue | isNotNullOrUndefined) && data.columnEditing === index ? editedValue : data.dataValue"
        [focus]="true"
        [readonly]="!column.editable || !(data.columnEditing === index || column.attribute?.constraint?.type === constraintType.Boolean)"
        [configuration]="configuration"
        (save)="onNewValue(index, $event)"
        (dblclick)="onDataInputDblClick(index, $event)"
        (cancel)="onDataInputCancel(index)"
        (click)="onDataInputFocus(index, $event)"
        (enterInvalid)="onEnterInvalid()">
      </data-input>
    </td>
    <td *ngIf="false"
        [innerHTML]="data.dataValue | previewDataValue | safeHtml"
        [class.focused]="data.columnFocused === index"
        class="text-pre overflow-hidden mx-1 align-middle"
        [title]="data.dataValue | formatDataValueTitle"
        [ngClass]="column.attribute?.constraint | constraintClass"
        [class.invalid-value]="!(data.dataValue | isDataValueValid)">
    </td>
  </ng-container>
</ng-container>
