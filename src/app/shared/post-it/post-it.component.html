<post-it-header *ngIf="(resource | resourceIconsColors) as data"
                class="card-header px-2 py-1"
                [class.cursor-move]="canDrag"
                [resource]="resource"
                [allowedPermissions]="allowedPermissions"
                [tag]="tag"
                [icons]="data.icons"
                [colors]="data.colors"
                [favorite]="dataResource | dataResourceFavorite"
                [resourceType]="resourceType"
                (remove)="onRemove()"
                (toggleFavorite)="toggleFavorite.emit()">
</post-it-header>

<div class="card-body p-2">

  <post-it-row *ngFor="let row of (dataRowService.rows$ | async); trackBy:trackByRow; let index = index"
               [row]="row"
               [permissions]="allowedPermissions"
               [cursor]="dataResource | dataCursor : row.attribute?.id"
               [constraintData]="constraintData"
               [readonly]="!(resource | resourceAttributeEditable : row.id: allowedPermissions: query)"
               [unusedAttributes]="unusedAttributes"
               (newValue)="onNewValue($event, row, index)"
               (newKey)="onNewKey($event, index)"
               (deleteRow)="onRemoveRow(index)"
               (onFocus)="onFocus(index, $event)"
               (onEdit)="onEdit(index, $event)"
               (resetFocusAndEdit)="onResetFocusAndEdit(index, $event)">
  </post-it-row>

  <div *ngIf="allowedPermissions?.writeWithView" class="pt-2 border-top clickable">
    <i class="fas fa-plus" (click)="onCreateRow()"></i>
  </div>

</div>
