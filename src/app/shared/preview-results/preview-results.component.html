<ng-container
  *ngIf="{collections: collections$ | async, documentsData: documentsData$ | async} as data">
  <ng-container *ngIf="data.collections && data.documentsData?.documents && data.documentsData?.loaded">

    <div *ngIf="data.collections.length; else noData">
      <ng-container *ngIf="data.collections.length > 1 || data.documentsData.documents.length > 0; else noData">
        <preview-results-tabs
          *ngIf="data.collections.length > 1"
          [collections]="data.collections"
          [selectedCollection]="selectedCollection?.id"
          (selectCollection)="setActiveCollection($event)">
        </preview-results-tabs>
        <preview-results-table
          *ngIf="selectedCollection"
          [documents]="data.documentsData.documents | documentsByCollection:selectedCollection?.id"
          [selectedDocumentId]="selectedDocument?.id"
          [loaded]="data.documentsData.loaded"
          [attributesSettings]="attributesSettings"
          [collection]="selectedCollection"
          [constraintData]="constraintData$ | async"
          (selectDocument)="setActiveDocument($event)">
        </preview-results-table>

      </ng-container>
    </div>

  </ng-container>
</ng-container>


<ng-template #noData>
  <empty-data [query]="query"></empty-data>
</ng-template>
